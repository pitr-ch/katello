<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: ContentView
  
    &mdash; Katello
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (C)</a> &raquo;
    
    
    <span class="title">ContentView</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: ContentView
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ActiveRecord::Base</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next">ContentView</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Authorization::ContentView, <span class='object_link'><a href="Ext/LabelFromName.html" title="Ext::LabelFromName (module)">Ext::LabelFromName</a></span>, <span class='object_link'><a href="Glue/ElasticSearch/ContentView.html" title="Glue::ElasticSearch::ContentView (module)">Glue::ElasticSearch::ContentView</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">
      <a href="https://github.com/Katello/katello/tree/master/app/models/content_view.rb" target="_blank">
        app/models/content_view.rb
      </a>
    </dd>
  
</dl>
<div class="clear"></div>





  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#created_at-instance_method" title="#created_at (instance method)">- (DateTime) <strong>created_at</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#default-instance_method" title="#default (instance method)">- (Boolean) <strong>default</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#description-instance_method" title="#description (instance method)">- (Text) <strong>description</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#label-instance_method" title="#label (instance method)">- (String) <strong>label</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (String) <strong>name</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#updated_at-instance_method" title="#updated_at (instance method)">- (DateTime) <strong>updated_at</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
  </ul>




  
    <h2>
      Belongs to
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_view_definition-instance_method" title="#content_view_definition (instance method)">- (ContentViewDefinition) <strong>content_view_definition</strong> </a>
    

    
      (also: #definition)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#environment_default-instance_method" title="#environment_default (instance method)">- (KTEnvironment) <strong>environment_default</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#organization-instance_method" title="#organization (instance method)">- (Organization) <strong>organization</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Has many
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#activation_keys-instance_method" title="#activation_keys (instance method)">- (Array&lt;ActivationKey&gt;) <strong>activation_keys</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#changeset_content_views-instance_method" title="#changeset_content_views (instance method)">- (Array&lt;ChangesetContentView&gt;) <strong>changeset_content_views</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#changesets-instance_method" title="#changesets (instance method)">- (Array&lt;Changeset&gt;) <strong>changesets</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#component_content_views-instance_method" title="#component_content_views (instance method)">- (Array&lt;ComponentContentView&gt;) <strong>component_content_views</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#composite_content_view_definitions-instance_method" title="#composite_content_view_definitions (instance method)">- (Array&lt;CompositeContentViewDefinition&gt;) <strong>composite_content_view_definitions</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_view_environments-instance_method" title="#content_view_environments (instance method)">- (Array&lt;ContentViewEnvironment&gt;) <strong>content_view_environments</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#content_view_versions-instance_method" title="#content_view_versions (instance method)">- (Array&lt;ContentViewVersion&gt;) <strong>content_view_versions</strong> </a>
    

    
      (also: #versions)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#composite-class_method" title="composite (class method)">+ (Object) <strong>composite</strong>(composite = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default-class_method" title="default (class method)">+ (Array&lt;ContentView&gt;) <strong>default</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>An array of ContentViews that are default.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_environment-class_method" title="in_environment (class method)">+ (Object) <strong>in_environment</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#non_default-class_method" title="non_default (class method)">+ (Array&lt;ContentView&gt;) <strong>non_default</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>An array of ContentViews that are non default.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#promoted-class_method" title="promoted (class method)">+ (Object) <strong>promoted</strong>(safe = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_environment-instance_method" title="#add_environment (instance method)">- (Object) <strong>add_environment</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Associate an environment with this content view.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_version_library_instances-instance_method" title="#all_version_library_instances (instance method)">- (Object) <strong>all_version_library_instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>get the library instances of all repos within this view.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_version_products-instance_method" title="#all_version_products (instance method)">- (Object) <strong>all_version_products</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>list all products associated to this view across all versions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_version_repos-instance_method" title="#all_version_repos (instance method)">- (Object) <strong>all_version_repos</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#as_json-instance_method" title="#as_json (instance method)">- (Object) <strong>as_json</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>NOTE: this function will most likely become obsolete once we drop api v1.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#components_not_in_env-instance_method" title="#components_not_in_env (instance method)">- (Object) <strong>components_not_in_env</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#composite-instance_method" title="#composite (instance method)">- (Object) <strong>composite</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#confirm_not_promoted-instance_method" title="#confirm_not_promoted (instance method)">- (Object) <strong>confirm_not_promoted</strong> </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cp_environment_id-instance_method" title="#cp_environment_id (instance method)">- (Object) <strong>cp_environment_id</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cp_environment_label-instance_method" title="#cp_environment_label (instance method)">- (Object) <strong>cp_environment_label</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(from_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#environments-instance_method" title="#environments (instance method)">- (Object) <strong>environments</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_repo_clone-instance_method" title="#get_repo_clone (instance method)">- (Object) <strong>get_repo_clone</strong>(env, repo) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_repos_to_promote-instance_method" title="#get_repos_to_promote (instance method)">- (Object) <strong>get_repos_to_promote</strong>(from_env, to_env) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_environment%3F-instance_method" title="#in_environment? (instance method)">- (Boolean) <strong>in_environment?</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#in_non_library_environment%3F-instance_method" title="#in_non_library_environment? (instance method)">- (Boolean) <strong>in_non_library_environment?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#index_repositories-instance_method" title="#index_repositories (instance method)">- (Object) <strong>index_repositories</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#library_repo_ids-instance_method" title="#library_repo_ids (instance method)">- (Object) <strong>library_repo_ids</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#prepare_repos_for_promotion-instance_method" title="#prepare_repos_for_promotion (instance method)">- (Object) <strong>prepare_repos_for_promotion</strong>(repos_to_replace, repos_to_promote) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#products-instance_method" title="#products (instance method)">- (Object) <strong>products</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#promote-instance_method" title="#promote (instance method)">- (Object) <strong>promote</strong>(from_env, to_env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#promote_repos-instance_method" title="#promote_repos (instance method)">- (Object) <strong>promote_repos</strong>(promote_version, to_env, promoting_repos) </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#promote_via_changeset-instance_method" title="#promote_via_changeset (instance method)">- (Object) <strong>promote_via_changeset</strong>(env, apply_options = {:async =&gt; true}, cs_name = &quot;#{self.name}_#{env.name}_#{Time.now.to_i}&quot;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#promoted%3F-instance_method" title="#promoted? (instance method)">- (Boolean) <strong>promoted?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#refresh_view-instance_method" title="#refresh_view (instance method)">- (Object) <strong>refresh_view</strong>(options = { }) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Refresh the content view, creating a new version in the library.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_environment-instance_method" title="#remove_environment (instance method)">- (Object) <strong>remove_environment</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Unassociate an environment from this content view.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#repos-instance_method" title="#repos (instance method)">- (Object) <strong>repos</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#repos_in_product-instance_method" title="#repos_in_product (instance method)">- (Object) <strong>repos_in_product</strong>(env, product) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_cp_content-instance_method" title="#update_cp_content (instance method)">- (Object) <strong>update_cp_content</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">- (Object) <strong>version</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version_environment-instance_method" title="#version_environment (instance method)">- (Object) <strong>version_environment</strong>(env) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Ext/LabelFromName.html" title="Ext::LabelFromName (module)">Ext::LabelFromName</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Ext/LabelFromName.html#included-class_method" title="Ext::LabelFromName.included (method)">included</a></span>, <span class='object_link'><a href="Ext/LabelFromName.html#setup_label_from_name-instance_method" title="Ext::LabelFromName#setup_label_from_name (method)">#setup_label_from_name</a></span></p>

  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="created_at=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="created_at-instance_method">
  
    - (<tt>DateTime</tt>) <strong>created_at</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 214</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_datetime'>datetime</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>created_at</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                                    <span class='symbol'>:null</span> <span class='op'>=&gt;</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="default=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="default-instance_method">
  
    - (<tt>Boolean</tt>) <strong>default</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 213</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_boolean'>boolean</span>  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>default</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                    <span class='symbol'>:default</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='symbol'>:null</span> <span class='op'>=&gt;</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="description=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="description-instance_method">
  
    - (<tt>Text</tt>) <strong>description</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Text</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 210</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>description</span><span class='tstring_end'>&quot;</span></span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="label=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="label-instance_method">
  
    - (<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>) <strong>label</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


209</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 209</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>label</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                                         <span class='symbol'>:null</span> <span class='op'>=&gt;</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    - (<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>) <strong>name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 208</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span>   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="updated_at=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="updated_at-instance_method">
  
    - (<tt>DateTime</tt>) <strong>updated_at</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>DateTime</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'db/schema.rb', line 215</span>

<span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_datetime'>datetime</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>updated_at</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>                                    <span class='symbol'>:null</span> <span class='op'>=&gt;</span> <span class='kw'>false</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="composite-class_method">
  
    + (<tt>Object</tt>) <strong>composite</strong>(composite = true) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 59</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_composite'>composite</span><span class='lparen'>(</span><span class='id identifier rubyid_composite'>composite</span><span class='op'>=</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_definition</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content_view_definition_bases.composite = ?</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id identifier rubyid_composite'>composite</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="default-class_method">
  
    + (<tt>Array&lt;<span class='object_link'><a href="" title="ContentView (class)">ContentView</a></span>&gt;</tt>) <strong>default</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>An array of ContentViews that are default. <strong>Active Record Scope</strong></p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="ContentView (class)">ContentView</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/NamedScope/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 51</span>

<span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:default</span><span class='comma'>,</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:default</span><span class='op'>=&gt;</span><span class='kw'>true</span><span class='rparen'>)</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_environment-class_method">
  
    + (<tt>Object</tt>) <strong>in_environment</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 54</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_versions</span> <span class='op'>=&gt;</span> <span class='symbol'>:content_view_version_environments</span><span class='rparen'>)</span><span class='period'>.</span>
    <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content_view_version_environments.environment_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="non_default-class_method">
  
    + (<tt>Array&lt;<span class='object_link'><a href="" title="ContentView (class)">ContentView</a></span>&gt;</tt>) <strong>non_default</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>An array of ContentViews that are non default. <strong>Active Record Scope</strong></p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="ContentView (class)">ContentView</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/NamedScope/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 52</span>

<span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:non_default</span><span class='comma'>,</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:default</span><span class='op'>=&gt;</span><span class='kw'>false</span><span class='rparen'>)</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promoted-class_method">
  
    + (<tt>Object</tt>) <strong>promoted</strong>(safe = false) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 80</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_promoted'>promoted</span><span class='lparen'>(</span><span class='id identifier rubyid_safe'>safe</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='comment'># retrieve the view, if it has been promoted (i.e. exists in more than 1 environment)
</span>  <span class='id identifier rubyid_relation'>relation</span> <span class='op'>=</span> <span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>distinct content_views.*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_versions</span> <span class='op'>=&gt;</span> <span class='symbol'>:environments</span><span class='rparen'>)</span><span class='period'>.</span>
             <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>environments.library IS NOT true AND content_views.default IS NOT true</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_safe'>safe</span>
    <span class='comment'># do not include group and having in returned relation
</span>    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span> <span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_relation'>relation</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:id</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_relation'>relation</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="activation_keys-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="ActivationKey.html" title="ActivationKey (class)">ActivationKey</a></span>&gt;</tt>) <strong>activation_keys</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ActivationKey.html" title="ActivationKey (class)">ActivationKey</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 40</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:activation_keys</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_environment-instance_method">
  
    - (<tt>Object</tt>) <strong>add_environment</strong>(env) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Associate an environment with this content view.  This can occur whenever
a version of the view is promoted to an environment.  It is necessary for
candlepin to become aware that the view is available for consumers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312
313
314
315
316
317
318</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 310</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_environment'>add_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_environments'>content_view_environments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:environment_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'>ContentViewEnvironment</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
                                   <span class='symbol'>:label</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cp_environment_label'>cp_environment_label</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='symbol'>:cp_id</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_cp_environment_id'>cp_environment_id</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='comma'>,</span>
                                   <span class='symbol'>:environment_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
                                   <span class='symbol'>:content_view</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_version_library_instances-instance_method">
  
    - (<tt>Object</tt>) <strong>all_version_library_instances</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>get the library instances of all repos within this view</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_version_library_instances'>all_version_library_instances</span>
  <span class='id identifier rubyid_all_repos'>all_repos</span> <span class='op'>=</span> <span class='id identifier rubyid_all_version_repos'>all_version_repos</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:library_instance_id</span><span class='op'>=&gt;</span><span class='kw'>nil</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>repositories.id</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_all_version_repos'>all_version_repos</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:library_instance_id</span><span class='rparen'>)</span>
  <span class='const'>Repository</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='op'>=&gt;</span><span class='id identifier rubyid_all_repos'>all_repos</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_version_products-instance_method">
  
    - (<tt>Object</tt>) <strong>all_version_products</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>list all products associated to this view across all versions</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 174</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_version_products'>all_version_products</span>
  <span class='const'>Product</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:environment_products</span><span class='op'>=&gt;</span><span class='symbol'>:repositories</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>repositories.id</span><span class='tstring_end'>'</span></span><span class='op'>=&gt;</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_all_version_repos'>all_version_repos</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_version_repos-instance_method">
  
    - (<tt>Object</tt>) <strong>all_version_repos</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_version_repos'>all_version_repos</span>
  <span class='const'>Repository</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_version</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content_view_versions.content_view_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="as_json-instance_method">
  
    - (<tt>Object</tt>) <strong>as_json</strong>(options = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>NOTE: this function will most likely become obsolete once we drop api v1</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_as_json'>as_json</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span>
  <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>organization</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>definition</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_definition'>content_view_definition</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>environments</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>versions</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:version</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>versions_details</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='lbrace'>{</span>
      <span class='symbol'>:version</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='comma'>,</span>
      <span class='symbol'>:published</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
      <span class='symbol'>:environments</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:environment</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>repositories</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:environment</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="changeset_content_views-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="ChangesetContentView.html" title="ChangesetContentView (class)">ChangesetContentView</a></span>&gt;</tt>) <strong>changeset_content_views</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ChangesetContentView.html" title="ChangesetContentView (class)">ChangesetContentView</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 38</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:changeset_content_views</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="changesets-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="Changeset.html" title="Changeset (class)">Changeset</a></span>&gt;</tt>) <strong>changesets</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Changeset.html" title="Changeset (class)">Changeset</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 39</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:changesets</span><span class='comma'>,</span> <span class='symbol'>:through</span> <span class='op'>=&gt;</span> <span class='symbol'>:changeset_content_views</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="component_content_views-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="ComponentContentView.html" title="ComponentContentView (class)">ComponentContentView</a></span>&gt;</tt>) <strong>component_content_views</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ComponentContentView.html" title="ComponentContentView (class)">ComponentContentView</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 34</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:component_content_views</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="components_not_in_env-instance_method">
  
    - (<tt>Object</tt>) <strong>components_not_in_env</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73
74
75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_components_not_in_env'>components_not_in_env</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># If this view was published from a composite definition, return the
</span>  <span class='comment'># list of component content views, if any, that do not exist in the environment
</span>  <span class='comment'># provided.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_composite'>composite</span>
    <span class='id identifier rubyid_content_view_definition'>content_view_definition</span><span class='period'>.</span><span class='id identifier rubyid_component_content_views'>component_content_views</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>distinct content_views.*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span>
            <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_versions</span> <span class='op'>=&gt;</span> <span class='symbol'>:content_view_version_environments</span><span class='rparen'>)</span><span class='period'>.</span>
            <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content_view_version_environments.content_view_version_id </span><span class='tstring_end'>&quot;</span></span>\
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NOT IN (SELECT content_view_version_id FROM </span><span class='tstring_end'>&quot;</span></span>\
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content_view_version_environments WHERE environment_id = ?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_env'>env</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="composite-instance_method">
  
    - (<tt>Object</tt>) <strong>composite</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_composite'>composite</span>
  <span class='id identifier rubyid_content_view_definition'>content_view_definition</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:composite?</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="composite_content_view_definitions-instance_method">
  
    - (<tt>Array&lt;CompositeContentViewDefinition&gt;</tt>) <strong>composite_content_view_definitions</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;CompositeContentViewDefinition&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 35</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:composite_content_view_definitions</span><span class='comma'>,</span>
<span class='symbol'>:through</span> <span class='op'>=&gt;</span> <span class='symbol'>:component_content_views</span><span class='comma'>,</span> <span class='symbol'>:source</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>content_view_definition</span><span class='tstring_end'>&quot;</span></span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="confirm_not_promoted-instance_method">
  
    - (<tt>Object</tt>) <strong>confirm_not_promoted</strong>  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


399
400
401
402
403
404
405</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 399</span>

<span class='kw'>def</span> <span class='id identifier rubyid_confirm_not_promoted'>confirm_not_promoted</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_promoted?'>promoted?</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:base</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cannot be deleted if it has been promoted.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="content_view_definition-instance_method">
  
    - (<tt><span class='object_link'><a href="ContentViewDefinition.html" title="ContentViewDefinition (class)">ContentViewDefinition</a></span></tt>) <strong>content_view_definition</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='definition-instance_method'>definition</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ContentViewDefinition.html" title="ContentViewDefinition (class)">ContentViewDefinition</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 22</span>

<span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:content_view_definition</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="content_view_environments-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="ContentViewEnvironment.html" title="ContentViewEnvironment (class)">ContentViewEnvironment</a></span>&gt;</tt>) <strong>content_view_environments</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ContentViewEnvironment.html" title="ContentViewEnvironment (class)">ContentViewEnvironment</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 26</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:content_view_environments</span><span class='comma'>,</span> <span class='symbol'>:dependent</span> <span class='op'>=&gt;</span> <span class='symbol'>:destroy</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="content_view_versions-instance_method">
  
    - (<tt>Array&lt;<span class='object_link'><a href="ContentViewVersion.html" title="ContentViewVersion (class)">ContentViewVersion</a></span>&gt;</tt>) <strong>content_view_versions</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='versions-instance_method'>versions</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ContentViewVersion.html" title="ContentViewVersion (class)">ContentViewVersion</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 28</span>

<span class='id identifier rubyid_has_many'>has_many</span> <span class='symbol'>:content_view_versions</span><span class='comma'>,</span> <span class='symbol'>:dependent</span> <span class='op'>=&gt;</span> <span class='symbol'>:destroy</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cp_environment_id-instance_method">
  
    - (<tt>Object</tt>) <strong>cp_environment_id</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301
302
303
304
305</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cp_environment_id'>cp_environment_id</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># The id for a default view, will simply be the env id; otherwise, it
</span>  <span class='comment'># will be a combination of env id and view id.  The reason being,
</span>  <span class='comment'># for a default view, the same candlepin environment will be referenced
</span>  <span class='comment'># by the kt_environment and content_view_environment.
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>-</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cp_environment_label-instance_method">
  
    - (<tt>Object</tt>) <strong>cp_environment_label</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


291
292
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 291</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cp_environment_label'>cp_environment_label</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># The label for a default view, will simply be the env label; otherwise, it
</span>  <span class='comment'># will be a combination of env and view label.  The reason being, the label
</span>  <span class='comment'># for a default view is internally generated (e.g. 'Default_View_for_dev')
</span>  <span class='comment'># and we do not need to expose it to the user.
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_default'>default</span> <span class='op'>?</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_label'>label</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_label'>label</span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_label'>label</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete-instance_method">
  
    - (<tt>Object</tt>) <strong>delete</strong>(from_env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 233</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_from_env'>from_env</span><span class='period'>.</span><span class='id identifier rubyid_library?'>library?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_in_non_library_environment?'>in_non_library_environment?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Errors</span><span class='op'>::</span><span class='const'>ChangesetContentException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid__'>_</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot delete view while it exits in environments</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Errors</span><span class='op'>::</span><span class='const'>ChangesetContentException</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid__'>_</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot delete from %s, view does not exist there.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>%</span> <span class='id identifier rubyid_from_env'>from_env</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='const'>ContentViewVersion</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='const'>Glue</span><span class='op'>::</span><span class='const'>Event</span><span class='period'>.</span><span class='id identifier rubyid_trigger'>trigger</span><span class='lparen'>(</span><span class='const'>Katello</span><span class='op'>::</span><span class='const'>Actions</span><span class='op'>::</span><span class='const'>ContentViewDemote</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span> <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="environment_default-instance_method">
  
    - (<tt><span class='object_link'><a href="KTEnvironment.html" title="KTEnvironment (class)">KTEnvironment</a></span></tt>) <strong>environment_default</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="KTEnvironment.html" title="KTEnvironment (class)">KTEnvironment</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 31</span>

<span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:environment_default</span><span class='comma'>,</span> <span class='symbol'>:class_name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>KTEnvironment</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:inverse_of</span> <span class='op'>=&gt;</span> <span class='symbol'>:default_content_view</span><span class='comma'>,</span>
<span class='symbol'>:foreign_key</span> <span class='op'>=&gt;</span> <span class='symbol'>:environment_default_id</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="environments-instance_method">
  
    - (<tt>Object</tt>) <strong>environments</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_environments'>environments</span>
  <span class='const'>KTEnvironment</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_versions</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content_view_versions.content_view_id</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_repo_clone-instance_method">
  
    - (<tt>Object</tt>) <strong>get_repo_clone</strong>(env, repo) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_repo_clone'>get_repo_clone</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lib_id'>lib_id</span> <span class='op'>=</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span> <span class='op'>||</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='const'>Repository</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:library_instance_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lib_id'>lib_id</span><span class='rparen'>)</span><span class='period'>.</span>
      <span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:content_view_version</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content_view_versions.content_view_id</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_repos_to_promote-instance_method">
  
    - (<tt>Object</tt>) <strong>get_repos_to_promote</strong>(from_env, to_env)  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 342</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_repos_to_promote'>get_repos_to_promote</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>
  <span class='comment'># Retrieve the repos that will end up in the to_env as a result of promoting this view.
</span>  <span class='comment'># The structure will be a hash, where key=repo.library_instance_id and value=repo
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_definition'>content_view_definition</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:composite?</span><span class='rparen'>)</span>
    <span class='comment'># For a composite view, the repos are based upon the component_content_views
</span>    <span class='comment'># currently in the to_env
</span>    <span class='id identifier rubyid_promoting_repos'>promoting_repos</span> <span class='op'>=</span> <span class='const'>Repository</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span><span class='period'>.</span>
        <span class='id identifier rubyid_in_content_views'>in_content_views</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_definition'>content_view_definition</span><span class='period'>.</span><span class='id identifier rubyid_component_content_views'>component_content_views</span><span class='rparen'>)</span><span class='period'>.</span>
        <span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='op'>|</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_repo'>repo</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='comment'># For a non-composite view, the repos are based upon the repos in
</span>    <span class='comment'># the from_env
</span>    <span class='id identifier rubyid_promoting_repos'>promoting_repos</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='op'>|</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_repo'>repo</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_promoting_repos'>promoting_repos</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_environment?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>in_environment?</strong>(env) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 128</span>

<span class='kw'>def</span> <span class='id identifier rubyid_in_environment?'>in_environment?</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="in_non_library_environment?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>in_non_library_environment?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


247
248
249</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 247</span>

<span class='kw'>def</span> <span class='id identifier rubyid_in_non_library_environment?'>in_non_library_environment?</span>
  <span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:library</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="index_repositories-instance_method">
  
    - (<tt>Object</tt>) <strong>index_repositories</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index_repositories'>index_repositories</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_repo'>repo</span><span class='op'>|</span>
    <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_index_packages'>index_packages</span>
    <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_index_errata'>index_errata</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="library_repo_ids-instance_method">
  
    - (<tt>Object</tt>) <strong>library_repo_ids</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_library_repo_ids'>library_repo_ids</span>
  <span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_library'>library</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='op'>|</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="organization-instance_method">
  
    - (<tt><span class='object_link'><a href="Organization.html" title="Organization (class)">Organization</a></span></tt>) <strong>organization</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Organization.html" title="Organization (class)">Organization</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 24</span>

<span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbol'>:organization</span><span class='comma'>,</span> <span class='symbol'>:inverse_of</span> <span class='op'>=&gt;</span> <span class='symbol'>:content_views</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepare_repos_for_promotion-instance_method">
  
    - (<tt>Object</tt>) <strong>prepare_repos_for_promotion</strong>(repos_to_replace, repos_to_promote)  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


363
364
365
366
367
368
369
370
371
372
373
374
375
376
377</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 363</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_repos_for_promotion'>prepare_repos_for_promotion</span><span class='lparen'>(</span><span class='id identifier rubyid_repos_to_replace'>repos_to_replace</span><span class='comma'>,</span> <span class='id identifier rubyid_repos_to_promote'>repos_to_promote</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>=</span> <span class='id identifier rubyid_repos_to_replace'>repos_to_replace</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_repos_to_promote'>repos_to_promote</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span><span class='rparen'>)</span>
      <span class='comment'># a version of this repo is being promoted, so clear it and later
</span>      <span class='comment'># we'll regenerate the content... this is more efficient than
</span>      <span class='comment'># destroying the repo and recreating it...
</span>      <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_clear_contents'>clear_contents</span>
    <span class='kw'>else</span>
      <span class='comment'># a version of this repo is not being promoted, so destroy it
</span>      <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
      <span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_tasks'>tasks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="products-instance_method">
  
    - (<tt>Object</tt>) <strong>products</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 168</span>

<span class='kw'>def</span> <span class='id identifier rubyid_products'>products</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_repos'>repos</span> <span class='op'>=</span> <span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='const'>Product</span><span class='period'>.</span><span class='id identifier rubyid_joins'>joins</span><span class='lparen'>(</span><span class='symbol'>:environment_products</span> <span class='op'>=&gt;</span> <span class='symbol'>:repositories</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:repositories</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='symbol'>:id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_repos'>repos</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:id</span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promote-instance_method">
  
    - (<tt>Object</tt>) <strong>promote</strong>(from_env, to_env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 202</span>

<span class='kw'>def</span> <span class='id identifier rubyid_promote'>promote</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot promote from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from_env'>from_env</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>, view does not exist there.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_replacing_version'>replacing_version</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_promote_version'>promote_version</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_promote_version'>promote_version</span> <span class='op'>=</span> <span class='const'>ContentViewVersion</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_promote_version'>promote_version</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_promote_version'>promote_version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_to_env'>to_env</span> <span class='kw'>unless</span> <span class='id identifier rubyid_promote_version'>promote_version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_promote_version'>promote_version</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

  <span class='id identifier rubyid_repos_to_promote'>repos_to_promote</span> <span class='op'>=</span> <span class='id identifier rubyid_get_repos_to_promote'>get_repos_to_promote</span><span class='lparen'>(</span><span class='id identifier rubyid_from_env'>from_env</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_replacing_version'>replacing_version</span>
    <span class='const'>PulpTaskStatus</span><span class='op'>::</span><span class='id identifier rubyid_wait_for_tasks'>wait_for_tasks</span> <span class='id identifier rubyid_prepare_repos_for_promotion'>prepare_repos_for_promotion</span><span class='lparen'>(</span><span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_repos_to_promote'>repos_to_promote</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>=</span> <span class='id identifier rubyid_promote_repos'>promote_repos</span><span class='lparen'>(</span><span class='id identifier rubyid_promote_version'>promote_version</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='comma'>,</span> <span class='id identifier rubyid_repos_to_promote'>repos_to_promote</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_replacing_version'>replacing_version</span>
    <span class='id identifier rubyid_replacing_version'>replacing_version</span> <span class='op'>=</span> <span class='const'>ContentViewVersion</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_readonly?'>readonly?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_replacing_version'>replacing_version</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'>Glue</span><span class='op'>::</span><span class='const'>Event</span><span class='period'>.</span><span class='id identifier rubyid_trigger'>trigger</span><span class='lparen'>(</span><span class='const'>Katello</span><span class='op'>::</span><span class='const'>Actions</span><span class='op'>::</span><span class='const'>ContentViewPromote</span><span class='comma'>,</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_from_env'>from_env</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_tasks'>tasks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promote_repos-instance_method">
  
    - (<tt>Object</tt>) <strong>promote_repos</strong>(promote_version, to_env, promoting_repos)  <span class="extras">(protected)</span>
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 379</span>

<span class='kw'>def</span> <span class='id identifier rubyid_promote_repos'>promote_repos</span><span class='lparen'>(</span><span class='id identifier rubyid_promote_version'>promote_version</span><span class='comma'>,</span> <span class='id identifier rubyid_to_env'>to_env</span><span class='comma'>,</span> <span class='id identifier rubyid_promoting_repos'>promoting_repos</span><span class='rparen'>)</span>
  <span class='comment'># promote the repos to the target env
</span>  <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_promoting_repos'>promoting_repos</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_library_instance_id'>library_instance_id</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='op'>|</span>
    <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_repo_clone'>get_repo_clone</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='comma'>,</span> <span class='id identifier rubyid_repo'>repo</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='comment'># this repo doesn't currently exist in the next environment, so create it
</span>      <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_create_clone'>create_clone</span><span class='lparen'>(</span><span class='id identifier rubyid_to_env'>to_env</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_clone_contents'>clone_contents</span><span class='lparen'>(</span><span class='id identifier rubyid_clone'>clone</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='comment'># this repo already exists in the next environment, so update it
</span>      <span class='id identifier rubyid_clone'>clone</span> <span class='op'>=</span> <span class='const'>Repository</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_clone'>clone</span><span class='rparen'>)</span> <span class='comment'># reload readonly obj
</span>      <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_content_view_version'>content_view_version</span> <span class='op'>=</span> <span class='id identifier rubyid_promote_version'>promote_version</span>
      <span class='id identifier rubyid_clone'>clone</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
      <span class='id identifier rubyid_tasks'>tasks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_repo'>repo</span><span class='period'>.</span><span class='id identifier rubyid_clone_contents'>clone_contents</span><span class='lparen'>(</span><span class='id identifier rubyid_clone'>clone</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_tasks'>tasks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promote_via_changeset-instance_method">
  
    - (<tt>Object</tt>) <strong>promote_via_changeset</strong>(env, apply_options = {:async =&gt; true}, cs_name = &quot;#{self.name}_#{env.name}_#{Time.now.to_i}&quot;) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196
197
198
199
200</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_promote_via_changeset'>promote_via_changeset</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_apply_options'>apply_options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='symbol'>:async</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rbrace'>}</span><span class='comma'>,</span>
                          <span class='id identifier rubyid_cs_name'>cs_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id identifier rubyid_transaction'>transaction</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_cs'>cs</span> <span class='op'>=</span> <span class='const'>PromotionChangeset</span><span class='period'>.</span><span class='id identifier rubyid_create!'>create!</span><span class='lparen'>(</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cs_name'>cs_name</span><span class='comma'>,</span>
                                    <span class='symbol'>:environment</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span>
                                    <span class='symbol'>:state</span> <span class='op'>=&gt;</span> <span class='const'>Changeset</span><span class='op'>::</span><span class='const'>REVIEW</span>
                                   <span class='rparen'>)</span>
    <span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_add_content_view!'>add_content_view!</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_apply'>apply</span><span class='lparen'>(</span><span class='id identifier rubyid_apply_options'>apply_options</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promoted?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>promoted?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_promoted?'>promoted?</span>
  <span class='comment'># if the view exists in more than 1 environment, it has been promoted
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="refresh_view-instance_method">
  
    - (<tt>Object</tt>) <strong>refresh_view</strong>(options = { }) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Refresh the content view, creating a new version in the library.  The new version will be returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 252</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refresh_view'>refresh_view</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:async</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='symbol'>:notify</span> <span class='op'>=&gt;</span> <span class='kw'>false</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span> <span class='id identifier rubyid_options'>options</span>

  <span class='comment'># retrieve the 'next' version id to use
</span>  <span class='id identifier rubyid_next_version_id'>next_version_id</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_maximum'>maximum</span><span class='lparen'>(</span><span class='symbol'>:version</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span>

  <span class='comment'># retrieve the version that is currently in the library and remove the library association.
</span>  <span class='comment'># at this point, we don't want to delete the version as we need to reference the repos it
</span>  <span class='comment'># contains during the refresh
</span>  <span class='id identifier rubyid_library_version'>library_version</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_library'>library</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_library_version'>library_version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_library'>library</span><span class='rparen'>)</span>

  <span class='comment'># create a new version
</span>  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='const'>ContentViewVersion</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:version</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_next_version_id'>next_version_id</span><span class='comma'>,</span> <span class='symbol'>:content_view</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_environments'>environments</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_library'>library</span>
  <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:async</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_task'>task</span>  <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_async'>async</span><span class='lparen'>(</span><span class='symbol'>:organization</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span>
                          <span class='symbol'>:task_type</span> <span class='op'>=&gt;</span> <span class='const'>TaskStatus</span><span class='op'>::</span><span class='const'>TYPES</span><span class='lbracket'>[</span><span class='symbol'>:content_view_refresh</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span>
                    <span class='id identifier rubyid_refresh_version'>refresh_version</span><span class='lparen'>(</span><span class='id identifier rubyid_library_version'>library_version</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:notify</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_task_status'>task_status</span> <span class='op'>=</span> <span class='id identifier rubyid_task'>task</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_task_status'>task_status</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_refresh_version'>refresh_version</span><span class='lparen'>(</span><span class='id identifier rubyid_library_version'>library_version</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:notify</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_version'>version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_environment-instance_method">
  
    - (<tt>Object</tt>) <strong>remove_environment</strong>(env) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Unassociate an environment from this content view. This can occur whenever
a view is deleted from an environment. It is necessary to make candlepin
aware that the view is no longer available for consumers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


323
324
325
326
327
328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 323</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_environment'>remove_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># Do not remove the content view environment, if there is still a view
</span>  <span class='comment'># version in the environment.
</span>  <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_view_env'>view_env</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_environments'>content_view_environments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:environment_id</span><span class='op'>=&gt;</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_view_env'>view_env</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span> <span class='kw'>unless</span> <span class='id identifier rubyid_view_env'>view_env</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="repos-instance_method">
  
    - (<tt>Object</tt>) <strong>repos</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_repos'>repos</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_repositories'>repositories</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="repos_in_product-instance_method">
  
    - (<tt>Object</tt>) <strong>repos_in_product</strong>(env, product) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_repos_in_product'>repos_in_product</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_product'>product</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_version'>version</span> <span class='op'>=</span> <span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_version'>version</span>
    <span class='id identifier rubyid_version'>version</span><span class='period'>.</span><span class='id identifier rubyid_repositories'>repositories</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_in_product'>in_product</span><span class='lparen'>(</span><span class='id identifier rubyid_product'>product</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span>
  <span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_cp_content-instance_method">
  
    - (<tt>Object</tt>) <strong>update_cp_content</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


285
286
287
288
289</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 285</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_cp_content'>update_cp_content</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># retrieve the environment and then update cp content
</span>  <span class='id identifier rubyid_view_env'>view_env</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_content_view_environments'>content_view_environments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:environment_id</span><span class='op'>=&gt;</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_view_env'>view_env</span><span class='period'>.</span><span class='id identifier rubyid_update_cp_content'>update_cp_content</span> <span class='kw'>if</span> <span class='id identifier rubyid_view_env'>view_env</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="version-instance_method">
  
    - (<tt>Object</tt>) <strong>version</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 132</span>

<span class='kw'>def</span> <span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_versions'>versions</span><span class='period'>.</span><span class='id identifier rubyid_in_environment'>in_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order'>order</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content_view_versions.id ASC</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="version_environment-instance_method">
  
    - (<tt>Object</tt>) <strong>version_environment</strong>(env) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/content_view.rb', line 136</span>

<span class='kw'>def</span> <span class='id identifier rubyid_version_environment'>version_environment</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='comment'># TODO: rewrite this into SQL or use content_view_environment when that
</span>  <span class='comment'># points to environment
</span>  <span class='id identifier rubyid_version'>version</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_content_view_version_environments'>content_view_version_environments</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_cvve'>cvve</span><span class='op'>|</span> <span class='id identifier rubyid_cvve'>cvve</span><span class='period'>.</span><span class='id identifier rubyid_environment_id'>environment_id</span> <span class='op'>==</span> <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jun  6 11:24:26 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.6.1 (ruby-1.9.3).
</div>

  </body>
</html>